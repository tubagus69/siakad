<chapter type="" id="en0605000000"><title><content-text>OSI Network Layer</content-text></title>
<section type="ChapterIntroduction" id="en0605000000"><title><content-text>Chapter Introduction</content-text></title>
<topic type="" id="en0605000100"><title><content-text>Chapter Introduction</content-text></title>
<page type="OneColumn" id="en0605000101">
<content-media type="StaticGraphic" id="cm5407354981"><title><content-text></content-text></title><media ref="en0605000000/en0605000000/en0605000100/en0605000101/cm5407354981.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605000000/en0605000100/en0605000101/cm5407354981text.xml"/></content-media>

<content-text><p>We have seen how network applications and services on one end device can communicate with applications and services running on another end device.</p><p>Next, as shown in the figure, we will consider how this data is communicated across the network - from the originating end device (or host) to the destination host - in an efficient way.</p><p>The protocols of the OSI model Network layer specify addressing and processes that enable Transport layer data to be packaged and transported. The Network layer encapsulation allows its contents to be passed to the destination within a network or on another network with minimum overhead. </p><p>This chapter focuses on the role of the Network layer - examining how it divides networks into groups of hosts to manage the flow of data packets within a network. We also consider how communication between networks is facilitated. This communication between networks is called routing. </p><p><b>Learning Objectives</b></p><p>Upon completion of this chapter, you will be able to:</p><ul><li>          Identify the role of the Network layer as it describes communication from one end device to another end device.</li>  <li>          Examine the most common Network layer protocol, Internet Protocol (IP), and its features for providing connectionless and best-effort service.</li>  <li>          Understand the principles used to guide the division, or grouping, of devices into networks.</li>  <li>          Understand the <content-link target="cg5704661494" type="glossary">hierarchical addressing</content-link> of devices and how this allows communication between networks.</li>  <li>          Understand the fundamentals of routes, <content-link target="cg4850856381" type="glossary">next-hop</content-link> addresses, and packet forwarding to a destination network.</li></ul>
</content-text>
</page>
</topic>
</section>
<section type="" id="en0605010000"><title><content-text>IPv4</content-text></title>
<topic type="" id="en0605010100"><title><content-text>Network Layer - Communication from Host to Host</content-text></title>
<page type="OneColumn" id="en0605010101">
<content-media type="AnimationPartialScreen" id="cm9973884478"><title><content-text></content-text></title><media ref="en0605000000/en0605010000/en0605010100/en0605010101/cm9973884478.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605010000/en0605010100/en0605010101/cm9973884478text.xml"/></content-media>

<content-text><p><b>The Network layer, or OSI Layer 3,</b><b> provides services to exchange the individual pieces of data over the network between identified end devices. </b>To accomplish this end-to-end transport, Layer 3 uses four basic processes:</p><ul><li>          Addressing</li>  <li>          Encapsulation</li>  <li>          Routing</li>  <li>          Decapsulation</li></ul>    <p><b>The animation in the figure demonstrates the exchange of data.</b></p><p><b>Addressing</b></p><p>First, the Network layer must provide a mechanism for addressing these end devices. If individual pieces of data are to be directed to an end device, that device must have a unique address. In an IPv4 network, when this address is added to a device, the device is then referred to as a host. </p><p><b>Encapsulation</b></p><p>Second, the Network layer must provide encapsulation. Not only must the devices be identified with an address, the individual pieces - the Network layer PDUs - must also contain these addresses. During the encapsulation process, Layer 3 receives the Layer 4 PDU and adds a Layer 3 header, or label, to create the Layer 3 PDU. When referring to the Network layer, we call this PDU a packet. When a packet is created, the header must contain, among other information, the address of the host to which it is being sent. This address is referred to as the destination address. The Layer 3 header also contains the address of the originating host. This address is called the <content-link target="cg1678204089" type="glossary">source address</content-link>.</p><p>After the Network layer completes its encapsulation process, the packet is sent down to the Data Link layer to be prepared for transportation over the media.</p><p><b>Routing</b></p><p>Next, the Network layer must provide services to direct these packets to their destination host. The source and destination hosts are not always connected to the same network. In fact, the packet might have to travel through many different networks. Along the way, each packet must be guided through the network to reach its final destination.<b> Intermediary devices that connect the networks are called routers. The role of the router is to select paths for and direct packets toward their destination. This process is known as routing.</b></p><p>During the routing through an internetwork, the packet may traverse many intermediary devices. Each route that a packet takes to reach the next device is called a <content-link target="cg5136399322" type="glossary">hop</content-link>. As the packet is forwarded, its contents (the Transport layer PDU), remain intact until the destination host is reached.</p><p><b>Decapsulation</b></p><p>Finally, the packet arrives at the destination host and is processed at Layer 3. The host examines the <content-link target="cg5844904467" type="glossary">destination address</content-link> to verify that the packet was addressed to this device. If the address is correct, the packet is decapsulated by the Network layer and the Layer 4 PDU contained in the packet is passed up to the appropriate service at Transport layer. </p><p>Unlike the Transport layer (OSI Layer 4), which manages the data transport between the processes running on each end host, <b>Network layer protocols specify the packet structure and processing </b><b>used to carry the data from one host to another host</b>. Operating without regard to the application data carried in each packet allows the Network layer to carry packets for multiple types of communications between multiple hosts.</p></content-text>
</page>
<page type="OneColumn" id="en0605010102">
<content-media type="StaticGraphic" id="cm8371305009"><title><content-text></content-text></title><media ref="en0605000000/en0605010000/en0605010100/en0605010102/cm8371305009.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605010000/en0605010100/en0605010102/cm8371305009text.xml"/></content-media>

<content-text><p><b>Network Layer Protocols</b></p><p>Protocols implemented at the Network layer that carry user data include:</p><ul><li>          Internet Protocol version 4 (IPv4)</li>  <li>          Internet Protocol version 6 (<content-link target="cg3332822554" type="glossary">IPv6</content-link>)</li>  <li>          Novell Internetwork Packet Exchange (IPX)</li>  <li>          AppleTalk</li>  <li>          Connectionless Network Service (CLNS/DECNet)</li></ul>    <p>The Internet Protocol (IPv4 and IPv6) is the most widely-used Layer 3 data carrying protocol and will be the focus of this course. Discussion of the other protocols will be minimal.</p></content-text>
</page>
</topic>
<topic type="" id="en0605010200"><title><content-text>The IP v4 Protocol - Example Network Layer Protocol</content-text></title>
<page type="OneColumn" id="en0605010201">
<content-media type="StaticGraphic" id="cm8845624976"><title><content-text></content-text></title><media ref="en0605000000/en0605010000/en0605010200/en0605010201/cm8845624976.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605010000/en0605010200/en0605010201/cm8845624976text.xml"/></content-media>

<content-text><p><b>Role of IPv4</b></p><p>As shown in the figure, the Network layer services implemented by the TCP/IP protocol suite are the Internet Protocol (IP). Version 4 of IP (IPv4) is currently the most widely-used version of IP. It is the only Layer 3 protocol that is used to carry user data over the Internet and is the focus of the CCNA. Therefore, it will be the example we use for Network layer protocols in this course.</p><p>IP version 6 (IPv6) is developed and being implemented in some areas. IPv6 will operate alongside IPv4 and may replace it in the future. The services provided by IP, as well as the packet header structure and contents, are specified by either IPv4 protocol or IPv6 protocol. These services and packet structure are used to encapsulate UDP datagrams or TCP segments for their trip across an internetwork.</p><p>The characteristics of each protocol are different. Understanding these characteristics will allow you to understand the operation of the services described by this protocol. </p><p>The Internet Protocol was designed as a protocol with low overhead. It provides only the functions that are necessary to deliver a packet from a source to a destination over an interconnected system of networks. The protocol was not designed to track and manage the flow of packets. These functions are performed by other protocols in other layers.</p><p>IPv4 basic characteristics:</p><ul><li>          Connectionless - No connection is established before sending data packets.</li>  <li>          Best Effort (unreliable) - No overhead is used to guarantee packet delivery.</li>  <li>          Media Independent - Operates independently of the medium carrying the data.</li></ul>  <p> </p></content-text>
</page>
</topic>
<topic type="" id="en0605010300"><title><content-text>The IP v4 Protocol - Connectionless</content-text></title>
<page type="OneColumn" id="en0605010301">
<content-media type="InteractiveGraphicHotspots" id="cm5904209904"><title><content-text></content-text></title><media ref="en0605000000/en0605010000/en0605010300/en0605010301/cm5904209904.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605010000/en0605010300/en0605010301/cm5904209904text.xml"/></content-media>

<content-text><p><b>Connectionless Service</b></p><p>An example of connectionless communication is sending a letter to someone without notifying the recipient in advance. As shown in the figure, the postal service still takes the letter and delivers it to the recipient. Connectionless data communications works on the same principle. IP packets are sent without notifying the end host that they are coming.</p><p>Connection-oriented protocols, such as TCP, require that control data be exchanged to establish the connection as well as additional fields in the PDU header. Because IP is connectionless, it requires no initial exchange of control information to establish an end-to-end connection before packets are forwarded, nor does it require additional fields in the PDU header to maintain this connection. This process greatly reduces the overhead of IP.</p><p>Connectionless packet delivery may, however, result in packets arriving at the destination out of sequence. If out-of-order or missing packets create problems for the application using the data, then upper layer services will have to resolve these issues.</p></content-text>
</page>
</topic>
<topic type="" id="en0605010400"><title><content-text>The IP v4 Protocol - Best Effort</content-text></title>
<page type="OneColumn" id="en0605010401">
<content-media type="StaticGraphic" id="cm8675871043"><title><content-text></content-text></title><media ref="en0605000000/en0605010000/en0605010400/en0605010401/cm8675871043.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605010000/en0605010400/en0605010401/cm8675871043text.xml"/></content-media>

<content-text><p><b>Best Effort Service (unreliable)</b></p><p>The IP protocol does not burden the IP service with providing reliability. Compared to a reliable protocol, the IP header is smaller. Transporting these smaller headers requires less overhead. Less overhead means less delay in delivery. This characteristic is desirable for a Layer 3 protocol.</p><p>The mission of Layer 3 is to transport the packets between the hosts while placing as little burden on the network as possible. Layer 3 is not concerned with or even aware of the type of communication contained inside of a packet. This responsibility is the role of the upper layers as required. The upper layers can decide if the communication between services needs reliability and if this communication can tolerate the overhead reliability requires. </p><p>IP is often referred to as an unreliable protocol. Unreliable in this context does not mean that IP works properly sometimes and does not function well at other times. Nor does it mean that it is unsuitable as a data communications protocol. <b>Unreliable means simply that IP does not have the capability to manage, and recover from, undelivered or corrupt packets.</b></p><p><b>Since protocols at other layers can manage reliability, IP is allowed to function very efficiently at the Network layer. </b>If we included reliability overhead in our Layer 3 protocol, then communications that do not require connections or reliability would be burdened with the bandwidth consumption and delay produced by this overhead. In the TCP/IP suite, the Transport layer can choose either TCP or UDP, based on the needs of the communication. As with all layer isolation provided by network models, leaving the reliability decision to the Transport layer makes IP more adaptable and accommodating for different types of communication. </p><p>The header of an IP packet does not include fields required for reliable data delivery. There are no acknowledgments of packet delivery. There is no error control for data. Nor is there any form of packet tracking; therefore, there is no possibility for packet retransmissions. </p></content-text>
</page>
</topic>
<topic type="" id="en0605010500"><title><content-text>The IP v4 Protocol - Media Independent</content-text></title>
<page type="OneColumn" id="en0605010501">
<content-media type="StaticGraphic" id="cm3326976537"><title><content-text></content-text></title><media ref="en0605000000/en0605010000/en0605010500/en0605010501/cm3326976537.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605010000/en0605010500/en0605010501/cm3326976537text.xml"/></content-media>

<content-text><p><b>Media Independent</b></p><p>The Network layer is also not burdened with the characteristics of the media on which packets will be transported. IPv4 and IPv6 operate independently of the media that carry the data at lower layers of the protocol stack. As shown in the figure, any individual IP packet can be communicated electrically over cable, as optical signals over fiber, or wirelessly as radio signals.</p><p>It is the responsibility of the OSI Data Link layer to take an IP packet and prepare it for transmission over the communications medium. This means that the transport of IP packets is not limited to any particular medium.</p><p>There is, however, one major characteristic of the media that the Network layer considers: the maximum size of PDU that each medium can transport. This characteristic is referred to as the <content-link target="cg7005729654" type="glossary">Maximum Transmission Unit (MTU)</content-link>. Part of the control communication between the Data Link layer and the Network layer is the establishment of a maximum size for the packet. The Data Link layer passes the MTU upward to the Network layer. The Network layer then determines how large to create the packets. </p><p>In some cases, an intermediary device - usually a router - will need to split up a packet when forwarding it from one media to a media with a smaller MTU. This process is called <i>fragmenting the packe</i>t or <i>fragmentation</i>. </p><p>Links</p><p>RFC-791 <content-link target="http://www.ietf.org/rfc/rfc0791.txt" type="external">http://www.ietf.org/rfc/rfc0791.txt </content-link> </p></content-text>
</page>
</topic>
<topic type="" id="en0605010600"><title><content-text>IP v4 Packet - Packaging the Transport Layer PDU</content-text></title>
<page type="OneColumn" id="en0605010601">
<content-media type="AnimationStepped" id="cm8136120030"><title><content-text></content-text></title><media ref="en0605000000/en0605010000/en0605010600/en0605010601/cm8136120030.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605010000/en0605010600/en0605010601/cm8136120030text.xml"/></content-media>

<content-text><p>IPv4 encapsulates, or packages, the Transport layer segment or datagram so that the network can deliver it to the destination host. Click the steps in the figure to see this process. The IPv4 encapsulation remains in place from the time the packet leaves the Network layer of the originating host until it arrives at the Network layer of the destination host.</p><p>The process of encapsulating data by layer enables the services at the different layers to develop and scale without affecting other layers. This means that transport layer segments can be readily packaged by existing Network layer protocols, such as IPv4 and IPv6 or by any new protocol that might be developed in the future. </p><p>Routers can implement these different Network layer protocols to operate concurrently over a network to and from the same or different hosts. The routing performed by these intermediary devices only considers the contents of the packet header that encapsulates the segment.</p><p>In all cases, the data portion of the packet - that is, the encapsulated Transport layer PDU - remains unchanged during the Network layer processes.</p><p>Links</p><p>RFC-791 <content-link target="http://www.ietf.org/rfc/rfc0791.txt" type="external">http://www.ietf.org/rfc/rfc0791.txt</content-link> </p></content-text>
</page>
</topic>
<topic type="" id="en0605010700"><title><content-text>IP v4 Packet Header</content-text></title>
<page type="OneColumn" id="en0605010701">
<content-media type="StaticGraphic" id="cm8487186180"><title><content-text></content-text></title><media ref="en0605000000/en0605010000/en0605010700/en0605010701/cm8487186180.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605010000/en0605010700/en0605010701/cm8487186180text.xml"/></content-media>

<content-text><p>As shown in the figure, an IPv4 protocol defines many different fields in the packet header. These fields contain <content-link target="cg4979017312" type="glossary">binary values</content-link> that the IPv4 services reference as they forward packets across the network.</p><p>This course will consider these 6 key fields:</p><ul><li> IP Source Address</li>  <li> IP Destination Address</li>  <li> Time-to-Live (TTL)</li>  <li> Type-of-Service (ToS)</li>  <li> Protocol</li>  <li>Fragment Offset</li></ul>    <p>Key IPv4 Header Fields</p><p>Roll over each field on the graphic to see its purpose.</p><p><b>IP Destination Address</b></p><p>The IP Destination Address field contains a 32-bit binary value that represents the packet destination Network layer host address.</p><p><b>IP Source Address</b></p><p>The IP Source Address field contains a 32-bit binary value that represents the packet source Network layer host address.</p><p><b>Time-to-Live</b></p><p>The Time-to-Live (TTL) is an 8-bit binary value that indicates the remaining "life" of the packet. The <content-link target="cg4812822384" type="glossary">TTL</content-link> value is decreased by at least one each time the packet is processed by a router (that is, each hop). When the value becomes zero, the router discards or drops the packet and it is removed from the network data flow. This mechanism prevents packets that cannot reach their destination from being forwarded indefinitely between routers in a <content-link target="cg6732151089" type="glossary">routing loop</content-link>. If routing loops were permitted to continue, the network would become congested with data packets that will never reach their destination. Decrementing the TTL value at each hop ensures that it eventually becomes zero and that the packet with the expired TTL field will be dropped.</p><p><b>Protocol</b></p><p>This 8-bit binary value indicates the data payload type that the packet is carrying. The Protocol field enables the Network layer to pass the data to the appropriate upper-layer protocol.</p><p>Example values are:</p><p>01 ICMP</p><p>06 TCP</p><p>17 UDP</p><p><b>Type-of-Service</b></p><p>The Type-of-Service field contains an 8-bit binary value that is used to determine the priority of each packet. This value enables a Quality-of-Service (QoS) mechanism to be applied to high priority packets, such as those carrying telephony voice data. The router processing the packets can be configured to decide which packet it is to forward first based on the Type-of-Service value. </p><p><b>Fragment Offset</b></p><p>As mentioned earlier, a router may have to fragment a packet when forwarding it from one medium to another medium that has a smaller MTU. When <content-link target="cg4397150856" type="glossary">fragmentation</content-link> occurs, the IPv4 packet uses the Fragment Offset field and the MF flag in the IP header to reconstruct the packet when it arrives at the destination host. The <content-link target="cg9015777781" type="glossary">fragment offset</content-link> field identifies the order in which to place the packet fragment in the reconstruction. </p><p><b>More Fragments flag</b></p><p>The More Fragments (MF) flag is a single bit in the Flag field used with the Fragment Offset for the fragmentation and reconstruction of packets. The More Fragments flag bit is set, it means that it is not the last fragment of a packet. When a receiving host sees a packet arrive with the MF = 1, it examines the Fragment Offset to see where this fragment is to be placed in the reconstructed packet. When a receiving host receives a frame with the MF = 0 and a non-zero value in the Fragment offset, it places that fragment as the last part of the reconstructed packet. An unfragmented packet has all zero fragmentation information (MF = 0, fragment offset =0). </p><p><b>Don't Fragment flag</b></p><p>The Don't Fragment (DF) flag is a single bit in the Flag field that indicates that fragmentation of the packet is not allowed. If the Don't Fragment flag bit is set, then fragmentation of this packet is NOT permitted. If a router needs to fragment a packet to allow it to be passed downward to the Data Link layer but the DF bit is set to 1, then the router will discard this packet. </p><p>Links:</p><p>RFC 791 <content-link target="http://www.ietf.org/rfc/rfc0791.txt" type="external">http://www.ietf.org/rfc/rfc0791.txt </content-link> </p><p>For a complete list of values of IP Protocol Number field</p><p><content-link target="http://www.iana.org/assignments/protocol-numbers" type="external">http://www.iana.org/assignments/protocol-numbers </content-link> </p></content-text>
</page>
<page type="OneColumn" id="en0605010702">
<content-media type="InteractiveGraphicRollovers" id="cm5548649058"><title><content-text></content-text></title><media ref="en0605000000/en0605010000/en0605010700/en0605010702/cm5548649058.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605010000/en0605010700/en0605010702/cm5548649058text.xml"/></content-media>

<content-text><p><b>Other IPv4 Header Fields</b></p><p>Roll over each field on the graphic to see its purpose.</p><p><b>Version - </b>Contains the IP version number (4)</p><p><b>Header Length (IHL) - </b>Specifies the size of the packet header. </p><p><b>Packet Length - </b>This field gives the entire packet size, including header and data, in bytes. </p><p><b>Identification - </b>This field is primarily used for uniquely identifying fragments of an original IP packet</p><p><b>Header Checksum - </b>The checksum field is used for error checking the packet header.</p><p><b>Options - </b>There is provision for additional fields in the IPv4 header to provide other services but these are rarely used.</p></content-text>
</page>
<page type="OneColumn" id="en0605010703">
<content-media type="StaticGraphic" id="cm8532939509"><title><content-text></content-text></title><media ref="en0605000000/en0605010000/en0605010700/en0605010703/cm8532939509.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605010000/en0605010700/en0605010703/cm8532939509text.xml"/></content-media>

<content-text><p><b>Typical IP Packet</b></p><p>The figure represents a complete IP packet with typical header field values.</p><p><b>Ver </b>= 4; IP version.</p><p><b>IHL </b>= 5; size of header in 32 bit words (4 bytes). This header is 5*4 = 20 bytes, the minimum valid size.</p><p><b>Total Length</b> = 472; size of packet (header and data) is 472 bytes.</p><p><b>Identification</b> = 111; original packet identifier (required if it is later fragmented).</p><p><b>Flag </b>= 0; denotes packet can be fragmented if required.</p><p><b>Fragment Offset</b> = 0; denotes that this packet is not currently fragmented (there is no offset).</p><p><b>Time to Live</b> = 123; denotes the Layer 3 processing time in seconds before the packet is dropped (decremented by at least 1 every time a device processes the packet header).</p><p><b>Protocol</b> = 6; denotes that the data carried by this packet is a TCP segment .</p></content-text>
</page>
</topic>
</section>
<section type="" id="en0605020000"><title><content-text>Networks - Dividing Hosts into Groups</content-text></title>
<topic type="" id="en0605020100"><title><content-text>Networks - Separating Hosts into Common Groups</content-text></title>
<page type="OneColumn" id="en0605020101">
<content-media type="InteractiveGraphicHotspots" id="cm1192807290"><title><content-text></content-text></title><media ref="en0605000000/en0605020000/en0605020100/en0605020101/cm1192807290.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605020000/en0605020100/en0605020101/cm1192807290text.xml"/></content-media>

<content-text><p>One of the major roles of the Network layer is to provide a mechanism for addressing hosts. As the number of hosts on the network grows, more planning is required to manage and address the network.</p><p><b>Dividing Networks</b></p><p>Rather than having all hosts everywhere connected to one vast global network, it is more practical and manageable to group hosts into specific networks. Historically, IP-based networks have their roots as one large network. As this single network grew, so did the issues related to its growth. To alleviate these issues, the large network was separated into smaller networks that were interconnected. These smaller networks are often called subnetworks or subnets. </p><p>Network and subnet are terms often used interchangeably to refer to any network system made possible by the shared common communication protocols of the TCP/IP model. </p><p>Similarly, as our networks grow, they may become too large to manage as a single network. At that point, we need to divide our network. When we plan the division of the network, we need to group together those hosts with common factors into the same network.</p><p>As shown in the figure, networks can be grouped based on factors that include:</p><ul><li>          Geographic location</li>  <li>          Purpose</li>  <li>          Ownership</li></ul>
</content-text>
</page>
<page type="OneColumn" id="en0605020102">
<content-media type="InteractiveGraphicHotspots" id="cm8376285450"><title><content-text></content-text></title><media ref="en0605000000/en0605020000/en0605020100/en0605020102/cm8376285450.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605020000/en0605020100/en0605020102/cm8376285450text.xml"/></content-media>

<content-text><p><b>Grouping Hosts Geographically</b></p><p>We can group network hosts together geographically. Grouping hosts at the same location - such as each building on a campus or each floor of a multi-level building - into separate networks can improve network management and operation.</p><p><b>Click the GEOGRAPHIC button on the figure.</b></p><p> </p><p><b>Grouping Hosts for Specific Purposes</b></p><p>Users who have similar tasks typically use common software, common tools, and have common traffic patterns. We can often reduce the traffic required by the use of specific software and tools by placing the resources to support them in the network with the users. </p><p>The volume of network data traffic generated by different applications can vary significantly. Dividing networks based on usage facilitates the effective allocation of network resources as well as authorized access to those resources. Network professionals need to balance the number of hosts on a network with the amount of traffic generated by the users. For example, consider a business that employs graphic designers who use the network to share very large multimedia files. These files consume most of the available bandwidth for most of the working day. The business also employs salespersons who only logged in once a day to record their sales transactions, which generates minimal network traffic. In this scenario, the best use of network resources would be to create several small networks to which a few designers had access and one larger network that all the salespersons used.</p><p><b>Click the PURPOSE button on the figure.</b></p><p><b>Grouping Hosts for Ownership</b></p><p>Using an organizational (company, department) basis for creating networks assists in controlling access to the devices and data as well as the administration of the networks. In one large network, it is much more difficult to define and limit the responsibility for the network personnel. Dividing hosts into separate networks provides a boundary for security enforcement and management of each network. </p><p><b>Click the OWNERSHIP button on the figure.</b></p><p>Links:</p><p>Network design <content-link target="http://www.cisco.com/univercd/cc/td/doc/cisintwk/idg4/nd2002.htm" type="external">http://www.cisco.com/univercd/cc/td/doc/cisintwk/idg4/nd2002.htm </content-link> </p></content-text>
</page>
</topic>
<topic type="" id="en0605020200"><title><content-text>Why Separate Hosts Into Networks? - Performance</content-text></title>
<page type="OneColumn" id="en0605020201">
<content-media type="InteractiveGraphicRollovers" id="cm8995886736"><title><content-text></content-text></title><media ref="en0605000000/en0605020000/en0605020200/en0605020201/cm8995886736.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605020000/en0605020200/en0605020201/cm8995886736text.xml"/></content-media>

<content-text><p>As mentioned previously, as networks grow larger they present problems that can be at least partially alleviated by dividing the network into smaller interconnected networks. </p><p>Common issues with large networks are:</p><ul><li>          Performance degradation</li>  <li>          Security issues</li>  <li>          Address Management</li></ul>    <p><b>Improving Performance </b></p><p>Large numbers of hosts connected to a single network can produce volumes of data traffic that may stretch, if not overwhelm, network resources such as bandwidth and routing capability.</p><p>Dividing large networks so that hosts who need to communicate are grouped together reduces the traffic across the internetworks. </p><p>In addition to the actual data communications between hosts, network management and control traffic (overhead) also increases with the number of hosts. A significant contributor to this overhead can be network broadcasts.</p><p>A broadcast is a message sent from one host to <b>all </b>other hosts on the network. Typically, a host initiates a broadcast when information about another unknown host is required. Broadcasts are a necessary and useful tool used by protocols to enable data communication on networks. However, large numbers of hosts generate large numbers of broadcasts that consume network bandwidth. And because every other host has to process the broadcast packet it receives, the other productive functions that a host is performing are also interrupted or degraded.</p><p>Broadcasts are contained within a network. In this context, a network is also known as a <content-link target="cg5042447451" type="glossary">broadcast domain</content-link>. Managing the size of broadcast domains by dividing a network into subnets ensures that network and host performances are not degraded to unacceptable levels.</p><p><b>Roll over OPTIMIZE GROUPING in the figure to see how to increase performance.</b></p></content-text>
</page>
<page type="OneColumn" id="en0605020202">
<content-media type="ActivityPKT" id="cm1858981148"><title><content-text></content-text></title><media ref="en0605000000/en0605020000/en0605020200/en0605020202/cm1858981148/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en0605000000/en0605020000/en0605020200/en0605020202/cm1858981148/icontext.xml"/></content-media>

<content-text><p>In this activity, the replacement of a switch with a router breaks one large broadcast domain into two more manageable ones. </p><p><b>Click the Packet Tracer icon to launch the Packet Tracer activity.</b></p></content-text>
</page>
</topic>
<topic type="" id="en0605020300"><title><content-text>Why Separate Hosts Into Networks? - Security</content-text></title>
<page type="OneColumn" id="en0605020301">
<content-media type="InteractiveGraphicRollovers" id="cm6558991663"><title><content-text></content-text></title><media ref="en0605000000/en0605020000/en0605020300/en0605020301/cm6558991663.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605020000/en0605020300/en0605020301/cm6558991663text.xml"/></content-media>

<content-text><p>The IP-based network that has become the Internet originally had a small number of trusted users in U.S. government agencies and the research organizations that they sponsored. In this small community, security was not a significant issue. </p><p>The situation has changed as individuals, businesses, and organizations have developed their own IP networks that link to the Internet. The devices, services, communications, and data are the property of those network owners. Network devices from other companies and organizations do not need to connect to their network.</p><p>Dividing networks based on ownership means that access to and from resources outside each network can be prohibited, allowed, or monitored.</p><p><b>Click the ACCESS GRANTED and ACCESS DENIED buttons on the figure to see different levels of security.</b></p><p>Internetwork access within a company or organization can be similarly secured. For example, a college network can be divided into administrative, research, and student subnetworks. Dividing a network based on user access is a means to secure communications and data from unauthorized access by users both within the organization and outside it.</p><p>Security between networks is implemented in an intermediary device (a router or firewall appliance) at the perimeter of the network. The firewall function performed by this device permits only known, trusted data to access the network.</p><p>Links:</p><p>IP network security</p><p><content-link target="http://www.cisco.com/univercd/cc/td/doc/cisintwk/ics/cs003.htm" type="external">http://www.cisco.com/univercd/cc/td/doc/cisintwk/ics/cs003.htm</content-link> </p></content-text>
</page>
</topic>
<topic type="" id="en0605020400"><title><content-text>Why Separate Hosts Into Networks? - Address Management</content-text></title>
<page type="OneColumn" id="en0605020401">
<content-media type="StaticGraphic" id="cm6157913532"><title><content-text></content-text></title><media ref="en0605000000/en0605020000/en0605020400/en0605020401/cm6157913532.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605020000/en0605020400/en0605020401/cm6157913532text.xml"/></content-media>

<content-text><p>The Internet consists of millions of hosts, each of which is identified by its unique Network layer address. To expect each host to know the address of every other host would impose a processing burden on these network devices that would severely degrade their performance.</p><p>Dividing large networks so that hosts who need to communicate are grouped together reduces the unnecessary overhead of all hosts needing to know all addresses. </p><p>For all other destinations, the hosts only need to know the address of an intermediary device, to which they send packets for all other destinations addresses. This intermediary device is called a <i>gateway</i>. The gateway is a router on a network that serves as an exit from that network. </p></content-text>
</page>
</topic>
<topic type="" id="en0605020500"><title><content-text>How Do We Separate Hosts Into Networks?  - Hierarchical Addressing</content-text></title>
<page type="OneColumn" id="en0605020501">
<content-media type="StaticGraphic" id="cm7266383277"><title><content-text></content-text></title><media ref="en0605000000/en0605020000/en0605020500/en0605020501/cm7266383277.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605020000/en0605020500/en0605020501/cm7266383277text.xml"/></content-media>

<content-text><p>To be able to divide networks, we need hierarchical addressing. A hierarchical address uniquely identifies each host. It also has levels that assist in forwarding packets across internetworks, which enables a network to be divided based on those levels.</p><p>To support data communications between networks over internetworks, Network layer addressing schemes are hierarchical.</p><p>As shown in the figure, postal addresses are prime examples of hierarchical addresses.</p><p>Consider the case of sending a letter from Japan to an employee working at Cisco Systems, Inc.</p><p>The letter would be addressed:</p><p><i>Employee Name</i></p><p>Cisco Systems, Inc.</p><p>170 West Tasman Drive</p><p>San Jose, CA 95134</p><p>USA</p><p>When a letter is posted in the country of origin, the postal authority would only look at the destination country and note that the letter was destined for the U.S. No other address details need to be processed at this level.</p><p>Upon arrival in the U.S., the post office first looks at the state, California. The city, street, and company name would not be examined if the letter still needed to be forwarded to the correct state. Once in California, the letter would be directed to San Jose. There the local mail <content-link target="cg8456339173" type="glossary">carrier</content-link> would take the letter to West Tasman Drive, and then refer to the street address and deliver it to 170. When the letter is actually on Cisco premises, the employee name would be used to forward it to its ultimate destination.</p><p>Referring only to the relevant address level (country, state, city, street, number, and employee) at each stage when directing the letter onto the next hop makes this process very efficient. There is no need for each forwarding stage to know the exact location of the destination; the letter was directed in the general direction until the employee's name was finally used at the destination.</p><p><content-link target="cg2401857996" type="glossary">Hierarchical</content-link> Network layer addresses work in much the same way. Layer 3 addresses supply the network portion of the address. Routers forward packets between networks by referring only to the part of the Network layer address that is required to direct the packet toward the destination network. By the time the packet arrives at the destination host network, the whole destination address of the host will have been used to deliver the packet.</p><p>If a large network needs to be divided into smaller networks, additional layers of addressing can be created. Using a hierarchical addressing scheme means that the higher levels of the address (similar to the country in the postal address) can be retained, with the middle level denoting the network addresses (state or city) and the lower level the individual hosts.</p></content-text>
</page>
</topic>
<topic type="" id="en0605020600"><title><content-text>Dividing the Networks - Networks from Networks</content-text></title>
<page type="OneColumn" id="en0605020601">
<content-media type="StaticGraphic" id="cm1672197733"><title><content-text></content-text></title><media ref="en0605000000/en0605020000/en0605020600/en0605020601/cm1672197733.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605020000/en0605020600/en0605020601/cm1672197733text.xml"/></content-media>

<content-text><p>If a large network has to be divided, additional layers of addressing can be created. Using hierarchical addressing means that the higher levels of the address are retained; with a subnetwork level and then the host level.</p><p>The logical 32-bit IPv4 address is hierarchical and is made up of two parts. The first part identifies the network and the second part identifies a host on that network. Both parts are required for a complete IP address. </p><p>For convenience IPv4 addresses are divided in four groups of eight bits (octets). Each <content-link target="cg8602328389" type="glossary">octet</content-link> is converted to its decimal value and the complete address written as the four decimal values separated by a dot (period).</p><p>For example - 192.168.18.57</p><p>In this example, as the figure shows, the first three octets, (192.168.18), can identify the network portion of the address, and the last octet, (57) identifies the host.</p><p>This is hierarchical addressing because the network portion indicates the network on which each unique host address is located. Routers only need to know how to reach each network, rather than needing to know the location of each individual host. </p><p>With IPv4 hierarchical addressing, the network portion of the address for all hosts in a network is the same. To divide a network, the network portion of the address is extended to use bits from the host portion of the address. These borrowed host bits are then used as network bits to represent the different subnetworks within the range of the original network. </p><p>Given that an IPv4 address is 32 bits, when host bits are used to divide a network the more subnetworks created results in fewer hosts for each subnetwork. Regardless of the number of subnetworks created however, all 32 bits are required to identify an individual host.</p><p>The number of bits of an address used as the network portion is called the prefix length. For example if a network uses 24 bits to express the network portion of an address the prefix is said to be /24. In the devices in an IPv4 network, a separate 32-bit number called a subnet mask indicates the prefix. </p><p>Note: Chapter 6 in this course will cover IPv4 network addressing and subnetworking in detail.</p><p>Extending the <content-link target="cg9978572882" type="glossary">prefix length</content-link> or subnet mask enables the creation of these subnetworks. In this way network administrators have the flexibility to divide networks to meet different needs, such as location, managing network performance, and security, while ensuring each host has a unique address.</p><p><b>For the purposes of explanation, however in this chapter the first 24 bits of an IPv4 address will be used as the network portion.</b></p><p>Links:</p><p>Internet Assigned Numbers Authority</p><p><content-link target="http://www.iana.org/" type="external">http://www.iana.org/ </content-link> </p></content-text>
</page>
</topic>
</section>
<section type="" id="en0605030000"><title><content-text>Routing - How Our Data Packets are Handled</content-text></title>
<topic type="" id="en0605030100"><title><content-text>Device Parameters - Supporting Communication Outside Our Network</content-text></title>
<page type="OneColumn" id="en0605030101">
<content-media type="StaticGraphic" id="cm8303138939"><title><content-text></content-text></title><media ref="en0605000000/en0605030000/en0605030100/en0605030101/cm8303138939.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605030000/en0605030100/en0605030101/cm8303138939text.xml"/></content-media>

<content-text><p>Within a network or a subnetwork, hosts communicate with each other without the need for any Network layer intermediary device. When a host needs to communicate with another network, an intermediary device, or router, acts as a gateway to the other network. </p><p>As a part of its configuration, a host has a default gateway address defined. As shown in the figure, this gateway address is the address of a router interface that is connected to the same network as the host. </p><p>Keep in mind that it is not feasible for a particular host to know the address of every device on the Internet with which it may have to communicate. To communicate with a device on another network, a host uses the address of this gateway, or default gateway, to forward a packet outside the local network.</p><p>The router also needs a route that defines where to forward the packet next. This is called the next-hop address. If a route is available to the router, the router will forward the packet to the next-hop router that offers a path to the destination network.</p><p>Links:</p><p>RFC 823 </p><p><content-link target="http://www.ietf.org/rfc/rfc0823.txt" type="external">http://www.ietf.org/rfc/rfc0823.txt</content-link> </p></content-text>
</page>
</topic>
<topic type="" id="en0605030200"><title><content-text>IP Packets - Carrying Data End to End</content-text></title>
<page type="OneColumn" id="en0605030201">
<content-media type="InteractiveGraphicHotspots" id="cm4663559969"><title><content-text></content-text></title><media ref="en0605000000/en0605030000/en0605030200/en0605030201/cm4663559969.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605030000/en0605030200/en0605030201/cm4663559969text.xml"/></content-media>

<content-text><p>As you know, the role of the Network layer is to transfer data from the host that originates the data to the host that uses it. During encapsulation at the source host, an IP packet is constructed Layer 3 to transport the Layer 4 PDU. If the destination host is in the same network as the source host, the packet is delivered between the two hosts on the local media without the need for a router.</p><p>However, if the destination host and source host are not in the same network, the packet may be carrying a Transport layer PDU across many networks and through many routers. As it does, the information contained within is not altered by any routers when forwarding decisions are made.</p><p>At each hop, the forwarding decisions are based on the information in the IP packet header. The packet with its Network Layer encapsulation also is basically intact throughout the complete process, from the source host to the destination host. </p><p>If communication is between hosts in different networks, the local network delivers the packet from the source to its gateway router. The router examines the network portion of the packet destination address and forwards the packet to the appropriate interface. If the destination network is <content-link target="cg1424033541" type="glossary">directly connected</content-link> to this router, the packet is forwarded directly to that host. If the destination network is not directly connected, the packet is forwarded on to a second router that is the next-hop router. </p><p>The packet forwarding then becomes the responsibility of this second router. Many routers or hops along the way may process the packet before reaching the destination.</p><p><b>Click the steps on the figure to follow the path of the IP packet.</b></p><p>Links:</p><p>RFC 791 <content-link target="http://www.ietf.org/rfc/rfc0791.txt" type="external">http://www.ietf.org/rfc/rfc0791.txt</content-link> </p><p>RFC 823 <content-link target="http://www.ietf.org/rfc/rfc0823.txt" type="external">http://www.ietf.org/rfc/rfc0823.txt</content-link> </p></content-text>
</page>
</topic>
<topic type="" id="en0605030300"><title><content-text>A Gateway - The Way Out of Our Network</content-text></title>
<page type="OneColumn" id="en0605030301">
<content-media type="InteractiveGraphicHotspots" id="cm1585531934"><title><content-text></content-text></title><media ref="en0605000000/en0605030000/en0605030300/en0605030301/cm1585531934.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605030000/en0605030300/en0605030301/cm1585531934text.xml"/></content-media>

<content-text><p>The gateway, also known as the default gateway, is needed to send a packet out of the local network. If the network portion of the destination address of the packet is different from the network of the originating host, the packet has to be routed outside the original network. To do this, the packet is sent to the gateway. This gateway is a router interface connected to the local network. The gateway interface has a Network layer address that matches the network address of the hosts. The hosts are configured to recognize that address as the gateway.</p><p><b>Default Gateway</b></p><p>The default gateway is configured on a host. On a Windows computer, the Internet Protocol (TCP/IP) Properties tools are used to enter the default gateway IPv4 address. Both the host IPv4 address and the gateway address must have the same network (and subnet, if used) portion of their respective addresses.</p><p><b>Roll over the graphic to display the Windows Properties.</b></p><p> </p><p> </p><p>Host gateway configuration <content-link target="http://www.microsoft.com/technet/community/columns/cableguy/cg0903.mspx" type="external">http://www.microsoft.com/technet/community/columns/cableguy/cg0903.mspx </content-link> </p></content-text>
</page>
<page type="OneColumn" id="en0605030302">
<content-media type="StaticGraphic" id="cm2672829938"><title><content-text></content-text></title><media ref="en0605000000/en0605030000/en0605030300/en0605030302/cm2672829938.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605030000/en0605030300/en0605030302/cm2672829938text.xml"/></content-media>

<content-text><p><b>Confirming the Gateway and Route</b></p><p>As shown in the figure, the IP address of the default gateway of a host can be viewed by issuing the <span class="cmd"><b>ipconfig </b></span>or <span class="cmd"><b>route </b></span>commands at the command line of a Windows computer. The <span class="cmd"><b>route </b></span>command is also used in a <content-link target="cg2716105288" type="glossary">Linux</content-link> or UNIX host.</p></content-text>
</page>
<page type="OneColumn" id="en0605030303">
<content-media type="StaticGraphic" id="cm2792638255"><title><content-text></content-text></title><media ref="en0605000000/en0605030000/en0605030300/en0605030303/cm2792638255.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605030000/en0605030300/en0605030303/cm2792638255text.xml"/></content-media>

<content-text><p><b>No packet can be forwarded without a route.</b> Whether the packet is originating in a host or being forwarded by an intermediary device, the device must have a route to identify where to forward the packet. </p><p>A host must either forward a packet to the host on the local network or to the gateway, as appropriate. To forward the packets, the host must have routes that represent these destinations. </p><p>A router makes a forwarding decision for each packet that arrives at the gateway interface. This forwarding process is referred to as routing. To forward a packet to a destination network, the router requires a route to that network. If a route to a destination network does not exist, the packet cannot be forwarded.</p><p>The destination network may be a number of routers or hops away from the gateway. The route to that network would only indicate the next-hop router to which the packet is to be forwarded, not the final router. The routing process uses a route to map the destination network address to the next hop and then forwards the packet to this next-hop address.</p><p>Links:</p><p>RFC 823 <content-link target="http://www.ietf.org/rfc/rfc0823.txt" type="external">http://www.ietf.org/rfc/rfc0823.txt</content-link> </p></content-text>
</page>
</topic>
<topic type="" id="en0605030400"><title><content-text>A Route - The Path to a Network</content-text></title>
<page type="OneColumn" id="en0605030401">
<content-media type="StaticGraphic" id="cm4830991773"><title><content-text></content-text></title><media ref="en0605000000/en0605030000/en0605030400/en0605030401/cm4830991773.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605030000/en0605030400/en0605030401/cm4830991773text.xml"/></content-media>

<content-text><p>A route for packets for remote destinations is added using the default gateway address as the next hop. Although it is not usually done, a host can also have routes manually added through configurations.</p><p>Like end devices, routers also add routes for the connected networks to their routing table. When a router interface is configured with an IP address and subnet mask, the interface becomes part of that network. The <content-link target="cg5812097232" type="glossary">routing table</content-link> now includes that network as a directly connected network. All other routes, however, must be configured or acquired via a routing protocol. To forward a packet the router must know where to send it. This information is available as routes in a routing table.</p><p>The routing table stores information about connected and remote networks. Connected networks are directly attached to one of the router interfaces. These interfaces are the gateways for the hosts on different local networks. Remote networks are networks that are not directly connected to the router. Routes to these networks can be manually configured on the router by the network administrator or learned automatically using dynamic <content-link target="cg7009407380" type="glossary">routing protocols</content-link>.</p><p>Routes in a routing table have three main features:</p><ul><li>          Destination network</li>  <li>          Next-hop</li>  <li>          Metric</li></ul>    <p>The router matches the destination address in the packet header with the destination network of a route in the routing table and forwards the packet to the next-hop router specified by that route. If there are two or more possible routes to the same destination, the metric is used to decide which route appears on the routing table.</p><p>As shown in the figure, the routing table in a Cisco router can be examined with the <span class="cmd"><b>show ip route</b></span> command. </p><p><b>Note:</b> The routing process and the role of metrics are the subject of a later course and will be covered in detail there.</p><p>As you know, packets cannot be forwarded by the router without a route. If a route representing the destination network is not on the routing table, the packet will be dropped (that is, not forwarded). The matching route could be either a connected route or a route to a remote network. The router may also use a <content-link target="cg1493425739" type="glossary">default route</content-link> to forward the packet. The default route is used when the destination network is not represented by any other route in the routing table. </p></content-text>
</page>
<page type="OneColumn" id="en0605030402">
<content-media type="StaticGraphic" id="cm4366667660"><title><content-text></content-text></title><media ref="en0605000000/en0605030000/en0605030400/en0605030402/cm4366667660.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605030000/en0605030400/en0605030402/cm4366667660text.xml"/></content-media>

<content-text><p><b>Host Routing Table</b></p><p>A host creates the routes used to forward the packets it originates. These routes are derived from the connected network and the configuration of the default gateway. </p><p>Hosts automatically add all connected networks to the routes. These routes for the local networks allow packets to be delivered to hosts that are connected to these networks.</p><p>Hosts also require a local routing table to ensure that Network layer packets are directed to the correct destination network. Unlike the routing table in a router, which contains both local and remote routes , the local table of the host typically contains its direct connection or connections to the network and its own default route to the gateway. Configuring the default gateway address on the host creates the local default route.</p><p>As shown in the figure, the routing table of a computer host can be examined at the command line by issuing the <span class="cmd">netstat -r</span>, <span class="cmd">route</span>, or <span class="cmd">route PRINT</span> commands. </p><p>In some circumstances, you may want to indicate more specific routes from a host. You can use the following options for the <span class="cmd">route</span> command to modify the routing table contents:</p><span class="cmd"><p>route ADD </p></span><span class="cmd"><p>route DELETE </p></span><span class="cmd"><p>route CHANGE</p></span><p>Links:</p><p>RFC 823 <content-link target="http://www.ietf.org/rfc/rfc0823.txt" type="external">http://www.ietf.org/rfc/rfc0823.txt</content-link> </p></content-text>
</page>
</topic>
<topic type="" id="en0605030500"><title><content-text>The Destination Network</content-text></title>
<page type="OneColumn" id="en0605030501">
<content-media type="StaticGraphic" id="cm9080424348"><title><content-text></content-text></title><media ref="en0605000000/en0605030000/en0605030500/en0605030501/cm9080424348.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605030000/en0605030500/en0605030501/cm9080424348text.xml"/></content-media>

<content-text><p><b>Routing Table Entries</b></p><p>The destination network shown in a routing table entry, called a route, represents a range of host addresses and sometimes a range of network and host addresses.</p><p>The hierarchical nature of Layer 3 addressing means that one route entry could refer to a large general network and another entry could refer to a subnet of that same network. When forwarding a packet, the router will select the most specific route.</p><p>Returning to the earlier postal addressing example, consider sending the same letter from Japan to 170 West Tasman Drive San Jose, California USA. Which address would you use: "USA" or "San Jose California USA" or "West Tasman Drive San Jose, California USA" or "170 West Tasman Drive San Jose, California USA"?</p><p>The fourth and most specific address would be used. However, for another letter where the street number was unknown, the third option would provide the best address match.</p><p>In the same way, a packet destined to the subnet of a larger network would be routed using the route to the subnet. However, a packet addressed to a different subnet within the same larger network would be routed using the more general entry.</p><p>As shown in the figure, if a packet arrives at a router with the destination address of 10.1.1.55, the router forwards the packet to a next-hop router associated with a route to network 10.1.1.0. If a route to 10.1.1.0 is not listed on the routing, but a route to 10.1.0.0 is available, the packet is forwarded to the next-hop router for that network.</p><p>Therefore, the precedence of route selection for the packet going to 10.1.1.55 would be:</p><p>1. 10.1.1.0</p><p>2. 10.1.0.0</p><p>3. 10.0.0.0</p><p>4. 0.0.0.0 (Default route if configured)</p><p>5. Dropped</p></content-text>
</page>
<page type="OneColumn" id="en0605030502">
<content-media type="StaticGraphic" id="cm6780165112"><title><content-text></content-text></title><media ref="en0605000000/en0605030000/en0605030500/en0605030502/cm6780165112.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605030000/en0605030500/en0605030502/cm6780165112text.xml"/></content-media>

<content-text><p><b>Default Route</b></p><p>A router can be configured to have a default route. A default route is a route that will match all destination networks. In IPv4 networks, the address 0.0.0.0 is used for this purpose. The default route is used to forward packets for which there is no entry in the routing table for the destination network. Packets with a destination network address that does not match a more specific route in the routing table are forwarded to the next-hop router associated with the default route.</p><p>Links:</p><p>RFC 823 <content-link target="http://www.ietf.org/rfc/rfc0823.txt" type="external">http://www.ietf.org/rfc/rfc0823.txt</content-link> </p></content-text>
</page>
</topic>
<topic type="" id="en0605030600"><title><content-text>The Next Hop - Where the Packet Goes Next</content-text></title>
<page type="OneColumn" id="en0605030601">
<content-media type="InteractiveGraphicRollovers" id="cm7520982609"><title><content-text></content-text></title><media ref="en0605000000/en0605030000/en0605030600/en0605030601/cm7520982609.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605030000/en0605030600/en0605030601/cm7520982609text.xml"/></content-media>

<content-text><p>A next-hop is the address of the device that will process the packet next. For a host on a network, the address of the default gateway (router interface) is the next-hop for all packets destined for another network.</p><p>In the routing table of a router, each route lists a next hop for each destination address that is encompassed by the route. As each packet arrives at a router, the destination network address is examined and compared to the routes in the routing table. When a matching route is determined, the next hop address for that route is used to forward of the packet toward its destination. The router then forwards the packet out the interface to which the next-hop router is connected. The next-hop router is the gateway to networks beyond that intermediate destination.</p><p>Networks directly connected to a router have no next-hop address because there is no intermediate Layer 3 device between the router and that network. The router can forward packets directly out the interface onto that network to the destination host.</p><p>Some routes can have multiple next-hops. This indicates that there are multiple paths to the same destination network. These are parallel routes that the router can use to forward packets. </p><p>Links:</p><p>RFC 823 <content-link target="http://www.ietf.org/rfc/rfc0823.txt" type="external">http://www.ietf.org/rfc/rfc0823.txt </content-link> </p></content-text>
</page>
</topic>
<topic type="" id="en0605030700"><title><content-text>Packet Forwarding - Moving the Packet Toward its Destination</content-text></title>
<page type="OneColumn" id="en0605030701">
<content-media type="InteractiveGraphicRollovers" id="cm1516239215"><title><content-text></content-text></title><media ref="en0605000000/en0605030000/en0605030700/en0605030701/cm1516239215.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605030000/en0605030700/en0605030701/cm1516239215text.xml"/></content-media>

<content-text><p>Routing is done <b>packet-by-packet and hop-by-hop</b>. Each packet is treated independently in each router along the path. At each hop, the router examines the destination IP address for each packet and then checks the routing table for forwarding information.</p><p>The router will do one of three things with the packet:</p><ul><li>          Forward it to the next-hop router</li>  <li>          Forward it to the destination host</li>  <li>          Drop it</li></ul>    <p><b>Packet Examination</b></p><p>As an intermediary device, a router processes the packet at the Network layer. However, packets that arrive at a router's interfaces are encapsulated as a Data Link layer (Layer 2) PDU. As show in the figure, the router first discards the Layer 2 encapsulation so that the packet can be examined.</p><p><b>Next Hop Selection</b></p><p>In the router, the destination address in a packet header is examined. If a matching route in the routing table shows that the destination network is directly connected to the router, the packet is forwarded to the interface to which that network is connected. In this case, there is no next-hop. To be placed onto the connected network, the packet has to be first re-encapsulated by the Layer 2 protocol and then forwarded out the interface.</p><p>If the route matching the destination network of the packet is a remote network, the packet is forwarded to the indicated interface, encapsulated by the Layer 2 protocol, and sent to the next-hop address.</p></content-text>
</page>
<page type="OneColumn" id="en0605030702">
<content-media type="StaticGraphic" id="cm4579960076"><title><content-text></content-text></title><media ref="en0605000000/en0605030000/en0605030700/en0605030702/cm4579960076.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605030000/en0605030700/en0605030702/cm4579960076text.xml"/></content-media>

<content-text><p><b>Using the Default Route</b></p><p>As shown in the figure, if the routing table does not contain a more specific route entry for an arriving packet, the packet is forwarded to the interface indicated by a default route, if one exists. At this interface, the packet is encapsulated by the Layer 2 protocol and sent to the next-hop router. The default route is also known as the <i>Gateway of Last Resort</i>.</p><p>This process may occur a number of times until the packet reaches its destination network. The router at each hop knows only the address of the next-hop; it does not know the details of the pathway to the remote destination host. Furthermore, not all packets going to the same destination will be forwarded to the same next-hop at each router. Routers along the way may learn new routes while the communication is taking place and forward later packets to different next-hops.</p><p>Default routes are important because the gateway router is not likely to have a route to every possible network on the Internet. If the packet is forwarded using a default route, it should eventually arrive at a router that has a specific route to the destination network. This router may be the router to which this network is attached. In this case, this router will forward the packet over the local network to the destination host. </p></content-text>
</page>
<page type="OneColumn" id="en0605030703">
<content-media type="StaticGraphic" id="cm4874567090"><title><content-text></content-text></title><media ref="en0605000000/en0605030000/en0605030700/en0605030703/cm4874567090.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605030000/en0605030700/en0605030703/cm4874567090text.xml"/></content-media>

<content-text><p>As a packet passes through the hops in the internetwork, all routers require a route to forward a packet. If, at any router, no route for the destination network is found in the routing table and there is no default route, that packet is dropped.</p><p>IP has no provision to return a packet to the previous router if a particular router has nowhere to send the packet. Such a function would detract from the protocol's efficiency and low overhead. Other protocols are used to report such errors. </p><p>Links:</p><p>RFC 823 <content-link target="http://www.ietf.org/rfc/rfc0823.txt" type="external">http://www.ietf.org/rfc/rfc0823.txt </content-link> </p></content-text>
</page>
<page type="OneColumn" id="en0605030704">
<content-media type="ActivityPKA" id="cm3058035279"><title><content-text></content-text></title><media ref="en0605000000/en0605030000/en0605030700/en0605030704/cm3058035279/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en0605000000/en0605030000/en0605030700/en0605030704/cm3058035279/icontext.xml"/></content-media>

<content-text><p>In this activity, the rules (algorithms) that routers use to make decisions on how to process packets, depending on the state of their routing tables when the packet arrives, are examined. </p><p><b>Click the Packet Tracer icon to launch the Packet Tracer activity.</b></p></content-text>
</page>
</topic>
</section>
<section type="" id="en0605040000"><title><content-text>Routing Processes:  How Routes are Learned</content-text></title>
<topic type="" id="en0605040100"><title><content-text>Routing Protocols - Sharing the Routes</content-text></title>
<page type="OneColumn" id="en0605040101">
<content-media type="StaticGraphic" id="cm6444036673"><title><content-text></content-text></title><media ref="en0605000000/en0605040000/en0605040100/en0605040101/cm6444036673.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605040000/en0605040100/en0605040101/cm6444036673text.xml"/></content-media>

<content-text><p>Routing requires that every hop, or router, along the path to a packet's destination have a route to forward the packet. Otherwise, the packet is dropped at that hop. Each router in a path does not need a route to all networks. It only needs to know the next hop on the path to the packet's destination network.</p><p>The routing table contains the information that a router uses in its packet forwarding decisions. For the routing decisions, the routing table needs to represent the most accurate state of network pathways that the router can access. Out-of-date routing information means that packets may not be forwarded to the most appropriate next-hop, causing delays or packet loss.</p><p>This route information can be manually configured on the router or learned dynamically from other routers in the same internetwork. After the interfaces of a router are configured and operational, the network associated with each interface is installed in the routing table as a directly connected route.</p></content-text>
</page>
</topic>
<topic type="" id="en0605040200"><title><content-text>Static Routing</content-text></title>
<page type="OneColumn" id="en0605040201">
<content-media type="StaticGraphic" id="cm4154782739"><title><content-text></content-text></title><media ref="en0605000000/en0605040000/en0605040200/en0605040201/cm4154782739.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605040000/en0605040200/en0605040201/cm4154782739text.xml"/></content-media>

<content-text><p>Routes to remote networks with the associated next hops can be manually configured on the router. This is known as <content-link target="cg3060005053" type="glossary">static routing</content-link>. A default route can also be statically configured.</p><p>If the router is connected to a number of other routers, knowledge of the internetworking structure is required. To ensure that the packets are routed to use the best possible next hops, each known destination network needs to either have a route or a default route configured. Because packets are forwarded at every hop, every router must be configured with static routes to next hops that reflect its location in the internetwork.</p><p>Further, if the internetwork structure changes or if new networks become available, these changes have to be manually updated on every router. If updating is not done in a timely fashion, the routing information may be incomplete or inaccurate, resulting in packet delays and possible packet loss.</p></content-text>
</page>
</topic>
<topic type="" id="en0605040300"><title><content-text>Dynamic Routing</content-text></title>
<page type="OneColumn" id="en0605040301">
<content-media type="StaticGraphic" id="cm1390607627"><title><content-text></content-text></title><media ref="en0605000000/en0605040000/en0605040300/en0605040301/cm1390607627.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605040000/en0605040300/en0605040301/cm1390607627text.xml"/></content-media>

<content-text><p>Although it is essential for all routers in an internetwork to have up-to-date extensive route knowledge, maintaining the routing table by manual static configuration is not always feasible. Therefore, dynamic routing protocols are used. Routing protocols are the set of rules by which routers dynamically share their routing information. As routers become aware of changes to the networks for which they act as the gateway, or changes to links between routers, this information is passed on to other routers. When a router receives information about new or changed routes, it updates its own routing table and, in turn, passes the information to other routers. In this way, all routers have accurate routing tables that are updated dynamically and can learn about routes to remote networks that are many hops way. An example of router sharing routes is shown in the figure.</p><p>Common routing protocols are:</p><ul><li>          Routing Information Protocol (RIP)</li>  <li>          Enhanced Interior Gateway Protocol (EIGRP)</li>  <li>          Open Shortest Path First (OSPF)</li></ul>    <p>Although routing protocols provide routers with up-to-date routing tables, there are costs. First, the exchange of route information adds overhead that consumes network bandwidth. This overhead can be an issue, particularly for low bandwidth links between routers. Second, the route information that a router receives is processed extensively by protocols such as EIGRP and OSPF to make routing table entries. This means that routers employing these protocols must have sufficient processing capacity to both implement the protocol's algorithms and to perform timely packet routing and forwarding.</p><p>Static routing does not produce any network overhead and places entries directly into the routing table; no processing is required by the router. The cost for static routing is administrative - the manual configuration and maintenance of the routing table to ensure efficient and effective routing.</p><p>In many internetworks, a combination of static, dynamic, and default routes are used to provide the necessary routes. The configuration of routing protocols on routers is an integral component of the CCNA and will be covered extensively by a later course.</p><p>Links:</p><p>RFC 823 <content-link target="http://www.ietf.org/rfc/rfc0823.txt" type="external">http://www.ietf.org/rfc/rfc0823.txt </content-link> </p><p>Routing basics <content-link target="http://www.cisco.com/univercd/cc/td/doc/cisintwk/ito_doc/routing.htm" type="external">http://www.cisco.com/univercd/cc/td/doc/cisintwk/ito_doc/routing.htm </content-link> </p></content-text>
</page>
<page type="OneColumn" id="en0605040302">
<content-media type="ActivityPKT" id="cm6042871837"><title><content-text></content-text></title><media ref="en0605000000/en0605040000/en0605040300/en0605040302/cm6042871837/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en0605000000/en0605040000/en0605040300/en0605040302/cm6042871837/icontext.xml"/></content-media>

<content-text><p>In this activity, you will examine a simple visualization of a dynamic routing protocol in "action."</p><p><b>Click the Packet Tracer icon to launch the Packet Tracer activity.</b></p></content-text>
</page>
</topic>
</section>
<section type="" id="en0605050000"><title><content-text>Labs</content-text></title>
<topic type="" id="en0605050100"><title><content-text>Lab - Examining a Device's Gateway</content-text></title>
<page type="OneColumn" id="en0605050101">
<content-media type="ActivityLab" id="cm1504336068"><title><content-text></content-text></title><media ref="en0605000000/en0605050000/en0605050100/en0605050101/cm1504336068/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="en0605000000/en0605050000/en0605050100/en0605050101/cm1504336068/icontext.xml"/></content-media>

<content-text><p>In this lab you will:</p><ul><li>          Examine the purpose of a gateway address.</li>  <li>          Configure network parameters on a Windows computer.</li>  <li>          Troubleshoot a hidden gateway address problem.</li></ul>
</content-text>
</page>
<page type="OneColumn" id="en0605050102">
<content-media type="ActivityPKA" id="cm3306044573"><title><content-text></content-text></title><media ref="en0605000000/en0605050000/en0605050100/en0605050102/cm3306044573/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en0605000000/en0605050000/en0605050100/en0605050102/cm3306044573/icontext.xml"/></content-media>

<content-text><p>This Packet Tracer activity will examine the role of the gateway in providing access to remote networks.</p><p><b>Click the Packet Tracer icon to launch the Packet Tracer activity.</b></p></content-text>
</page>
</topic>
<topic type="" id="en0605050200"><title><content-text>Lab - Examining a Route</content-text></title>
<page type="OneColumn" id="en0605050201">
<content-media type="ActivityLab" id="cm7393959896"><title><content-text></content-text></title><media ref="en0605000000/en0605050000/en0605050200/en0605050201/cm7393959896/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="en0605000000/en0605050000/en0605050200/en0605050201/cm7393959896/icontext.xml"/></content-media>

<content-text><p>In this lab you will:</p><ul><li>          Use the <span class="cmd"><b>route </b></span>command to modify a Windows computer route table.</li>  <li>          Use a Windows Telnet client to connect to a Cisco router.</li>  <li>          Examine router routes using basic Cisco <content-link target="cg9038440553" type="glossary">IOS</content-link> commands.</li></ul>
</content-text>
</page>
<page type="OneColumn" id="en0605050202">
<content-media type="ActivityPKA" id="cm7375059987"><title><content-text></content-text></title><media ref="en0605000000/en0605050000/en0605050200/en0605050202/cm7375059987/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en0605000000/en0605050000/en0605050200/en0605050202/cm7375059987/icontext.xml"/></content-media>

<content-text><p>In this lab you will use Packet Tracer to examine router routing tables using basic Cisco IOS commands.</p><p><b>Click the Packet Tracer icon to launch the Packet Tracer activity.</b></p></content-text>
</page>
</topic>
</section>
<section type="ChapterSummary" id="en0605060000"><title><content-text>Summary</content-text></title>
<topic type="" id="en0605060100"><title><content-text>Summary</content-text></title>
<page type="OneColumn" id="en0605060101">
<content-media type="StaticGraphic" id="cm5108077994"><title><content-text></content-text></title><media ref="en0605000000/en0605060000/en0605060100/en0605060101/cm5108077994.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605060000/en0605060100/en0605060101/cm5108077994text.xml"/></content-media>

<content-text><p>The most significant Network layer (OSI Layer 3) protocol is the Internet Protocol (IP). IP version 4 (IPv4) is the Network layer protocol that will be used as an example throughout this course.</p><p>Layer 3 IP routing does not guarantee reliable delivery or establish a connection before data is transmitted. This connectionless and unreliable communication is fast and flexible, but upper layers must provide mechanisms to guarantee delivery of data if it is needed.</p><p>The role of the Network layer is to carry data from one host to another regardless of the type of data. The data is encapsulated in a packet. The packet header has fields that include the destination address of the packet.</p><p>Hierarchical Network layer addressing, with network and host portions, facilitates the division of networks in to subnets and enables the network address to be used for forwarding packets toward the destination instead of using each individual host address.</p><p>If the destination address is not on the same network as the source host, the packet is passed to the default gateway for forwarding to the destination network. The gateway is an interface of a router that examines the destination address. If the destination network has an entry in its routing table, the router forwards the packet either to a connected network or to the next-hop gateway. If no routing entry exists, the router may forward the packet on to a default route, or drop the packet.</p><p>Routing table entries can be configured manually on each router to provide static routing or the routers may communicate route information dynamically between each other using a routing protocol.</p></content-text>
</page>
<page type="FullScreen" id="en0605060102">
<content-media type="ChapterSummary" id="cm8000119444"><title><content-text></content-text></title><media ref="en0605000000/en0605060000/en0605060100/en0605060102/cm8000119444.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605060000/en0605060100/en0605060102/cm8000119444text.xml"/></content-media>

<content-text></content-text>
</page>
<page type="OneColumn" id="en0605060103">
<content-media type="ActivityPKA" id="cm1972509424"><title><content-text></content-text></title><media ref="en0605000000/en0605060000/en0605060100/en0605060103/cm1972509424/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en0605000000/en0605060000/en0605060100/en0605060103/cm1972509424/icontext.xml"/></content-media>

<content-text><p>In this activity, you will use a GUI to perform simple router configuration so that IP packets can be routed. This is a key step in building a more complete model of the Exploration lab topology. </p><p><content-link target="E1_PTAct_5_6_1_Directions.pdf" type="internalfile">Packet Tracer Skills Integration Instructions (PDF)</content-link> </p><p><b>Click the Packet Tracer icon to launch the Packet Tracer activity.</b></p></content-text>
</page>
<page type="OneColumn" id="en0605060104">
<content-media type="StaticGraphic" id="cm2332869116"><title><content-text></content-text></title><media ref="en0605000000/en0605060000/en0605060100/en0605060104/cm2332869116.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0605000000/en0605060000/en0605060100/en0605060104/cm2332869116text.xml"/></content-media>

<content-text><p><b>Reflection Questions</b></p><p>Discuss how lost data can be re-sent when the Network Layer uses unreliable and connectionless means of packet forwarding.</p><p>Discuss the network circumstances in which it would be more advantageous to use static routing instead of dynamic routing protocols.</p><p><b>Links</b></p><p>Introduction to internetworking</p><p><content-link target="http://www.cisco.com/univercd/cc/td/doc/cisintwk/ito_doc/introint.htm" type="external">http://www.cisco.com/univercd/cc/td/doc/cisintwk/ito_doc/introint.htm </content-link> </p></content-text>
</page>
</topic>
</section>
<section type="ChapterQuiz" id="en0605070000"><title><content-text>Quiz</content-text></title>
<topic type="" id="en0605070100"><title><content-text>Chapter Quiz</content-text></title>
<page type="FullScreen" id="en0605070101">
<content-media type="ChapterQuiz" id="cm6620463298"><title><content-text></content-text></title><media ref="en0605000000/en0605070000/en0605070100/en0605070101/cm6620463298/" mime="" scale="true" type="directory" width="100%" height="100%" external="en0605000000/en0605070000/en0605070100/en0605070101/cm6620463298/icontext.xml"/></content-media>

<content-text></content-text>
</page>
</topic>
</section>
</chapter>
